## 所有権
- 値とは、メモリ上にあるデータのこと
- 変数とは、コード内で定義される、「値に紐づいた記号」のこと。プログラミングにおける普通の意味での変数
- rustにおいて、すべての値はその所有者と呼ばれる変数を持つ。値の所有者はコード（正確にはバイナリ？）の実行の各時点で一意に定まる。コードの実行が進むにつれて所有者が刻一刻と変化していく、ということはあり得る。
- 値の所有者が変化するのは、基本的に「変数への代入」である。
    - 関数呼び出しで「関数に所有権が移動する」と言っているのは、正確には関数の仮引数に所有権が移動する、ということ。
- スコープを抜けた、または所有している値を奪われた（所有権が他の変数に移動した）変数は、その時点でdropされる。つまりその変数はその後使用できなくなる。変数がヒープ領域にあったりすると、同時にその変数がおいてあったメモリ領域が解放されることもある。
- 所有者がいなくなった値は自動的に破棄される。

## 参照と借用
- 所有権システムがあるので、pythonみたいに何も考えずに関数に変数の値を渡したりすると呼び出し元でその変数が使えなくなる、みたいなことが起きる。
- これは嫌なので、参照を利用する。
- shared xor mutableの原則
    - ある変数への参照は、複数の不変参照もしくは1つの可変参照のどちらか一方の状況のみが許容される。
- 参照のサイズは基本的に1 word（32bit コンピュータなら32bit = 4byte, 64bitなら64bit = 8byte）
    - こういうのをthin pointerという。
    - メモリアドレスに加えて、参照先のサイズとかも保持するfat pointerというのもある。&strとか。

## Trait
- orphan ruleとは、「そのcrate内にないtraitを、そのcrate内にない型に対して実装することはできない」という規則。
- 

## 文字列
- str型
    - 有効なUTF8テキストが格納されたu8のsequenceのこと。これはサイズ不定（コンパイル時にサイズが決まらない）型で、メモリ上のどこかにある配列そのものを表す。サイズ不定型なので、直接instantiateできない。実際のコードに現れるものというよりも、型システムにおける概念的な型だと思うべき。
- &str型
    - str型へのスライス。実態はfat pointerで、1つのメモリアドレスとそこから始まる文字列の長さからなる。
- String型
    - heap領域に確保される有効なUTF8テキストのサイズ可変な列。実態はVec<u8>で、メモリ配置としてはheap領域に確保されたバッファと、stack領域に置かれた（その先頭へのポインタ、バッファサイズ、文字列の長さ）の組。
- これらの間の重要な関係として、&String型を&str型にゼロコストでキャストできる（Deref）というのがある。気持ちとしては「Stringへの参照を、その中身であるheap上の配列へのスライスだと思う」あたりだろうか。
- また、String型のスライスは&str型になる。&Stringにならないのはなぜでしょう？
    - 正解は、&String型はただのthin pointerで、「どこをスライスするか」の情報をもてないから。fat pointerでないといけない。
    - もちろん&String型を&str型に変換することはできるが、その場合参照先のString全体のスライスにするしかない。（どこをスライスするかの情報を持っていないので）（するしかない、というより最も自然な変換の仕方はこれだろう、という意味）
    - 結局のところ文字列のスライスの気持ちは「ある文字列の部分文字列 without 所有権」みたいなものだから、それは&str型だよね、みたいな感じかな（実際は順序が逆かもしれないが。スライスの概念を型に落とし込もうとして&str型が生まれ、所有権を剥奪するために参照にしようとして参照元となるstr型を作った、と思った方が自分には理解しやすい）

## 式 (expression)
- expressionには値があり、statementにはない。Cには両方登場する。
- rustではexpressionのみ
- 例えばif式がある。よって三項演算子がいらない。
    - if ok {1} else {0} とすればいい
- rustのコードは、expressionのなすtreeみたいになっている。ブロック{}によってchild/parentの関係ができる
    - 厳密にはブロックの中にはexpression, semi-colon ;, および宣言を書くことができる。

## パターン
- match文の=>の左側に置かれる部分を、パターンという。
- 式は値を生成し、パターンは値を消費する。
